<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.midnear.midnearshopping.mapper.review.ReviewsMapper">

    <insert id="insertReview" useGeneratedKeys="true" keyProperty="reviewId">
        INSERT INTO reviews (
            created_at,
            modified_date,
            rating,
            review,
            review_status,
            user_id,
            user_product_id
        ) VALUES (
                     #{createdAt},
                     #{modifiedDate},
                     #{rating},
                     #{review},
                     #{reviewStatus},
                     #{userId},
                     #{userProductId}
                 )
    </insert>

    <select id="getReviewById" resultType="com.midnear.midnearshopping.domain.vo.review.ReviewsVO">
        SELECT * FROM reviews WHERE review_id = #{reviewId}
    </select>

    <select id="getReviewsByProductId" resultType="com.midnear.midnearshopping.domain.vo.review.ReviewsVO">
        SELECT * FROM reviews WHERE user_product_id = #{userProductId} ORDER BY created_at DESC
    </select>

    <update id="updateReview">
        UPDATE reviews
        SET modified_date = #{modifiedDate},
            rating = #{rating},
            review = #{review},
            review_status = #{reviewStatus}
        WHERE review_id = #{reviewId}
    </update>

    <delete id="deleteReview">
        DELETE FROM reviews WHERE review_id = #{reviewId}
    </delete>

</mapper>
